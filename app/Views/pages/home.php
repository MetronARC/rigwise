<?= $this->extend('template/index') ?>

<?= $this->section('content') ?>

<main class="main">
    <!-- Hero Section -->
    <section id="hero" class="hero section position-relative">
        <!-- Background Slideshow -->
        <div id="heroSlideshow" class="hero-slideshow">
            <!-- Hero slides will be inserted here by JavaScript -->
        </div>
        
        <!-- Content Overlay -->
        <div class="hero-overlay"></div>
        
        <div class="container position-relative" data-aos="fade-up" data-aos-delay="100">
            <div class="row align-items-center">
                <div class="col-lg-6">
                    <div class="hero-content" data-aos="fade-up" data-aos-delay="200">
                        <h1 class="mb-4 text-white">
                            Welcome to <br />
                            <span class="accent-text">Rigwise Technologies Pte Ltd</span>
                        </h1>

                        <p class="mb-4 mb-md-5 text-white">
                        Expert MWS and OVID Inspector, delivering marine safety and audit products to industry. Expert in Marine Project Management, Operations, and Strategy. History of Building and maintaining strong client relations.
                        </p>
                    </div>
                </div>
            </div>

            <div
                class="row stats-row gy-4 mt-5"
                data-aos="fade-up"
                data-aos-delay="500">
                <div class="col-lg-3 col-sm-6">
                    <div class="stat-item">
                        <div class="stat-icon">
                            <i class="bi bi-check2"></i>
                        </div>
                        <div class="stat-content">
                            <h4>Accredited OVID Inspector</h4>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-sm-6">
                    <div class="stat-item">
                        <div class="stat-icon">
                            <i class="bi bi-check2"></i>
                        </div>
                        <div class="stat-content">
                            <h4>Marine Warranty</h4>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-sm-6">
                    <div class="stat-item">
                        <div class="stat-icon">
                            <i class="bi bi-check2"></i>
                        </div>
                        <div class="stat-content">
                            <h4>Marine Consultant</h4>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-sm-6">
                    <div class="stat-item">
                        <div class="stat-icon">
                            <i class="bi bi-check2"></i>
                        </div>
                        <div class="stat-content">
                            <h4>Rig Mover</h4>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-sm-6">
                    <div class="stat-item">
                        <div class="stat-icon">
                            <i class="bi bi-check2"></i>
                        </div>
                        <div class="stat-content">
                            <h4>Rig Specialist</h4>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-sm-6">
                    <div class="stat-item">
                        <div class="stat-icon">
                            <i class="bi bi-check2"></i>
                        </div>
                        <div class="stat-content">
                            <h4>Marine Layup Service</h4>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-sm-6">
                    <div class="stat-item">
                        <div class="stat-icon">
                            <i class="bi bi-check2"></i>
                        </div>
                        <div class="stat-content">
                            <h4>Marine Warranty Surveyor</h4>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-sm-6">
                    <div class="stat-item">
                        <div class="stat-icon">
                            <i class="bi bi-check2"></i>
                        </div>
                        <div class="stat-content">
                            <h4>Marine Advisor</h4>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- /Hero Section -->

    <!-- About Section -->
    <section id="about" class="about section">
        <div class="container" data-aos="fade-up" data-aos-delay="100">
            <div class="row gy-4 align-items-center justify-content-between">
                <div class="col-xl-5" data-aos="fade-up" data-aos-delay="200">
                    <span class="about-meta">MORE ABOUT US</span>
                    <h2 class="about-title">
                        Rigs, ships and the vessels that move them
                    </h2>
                    
                    <div class="service-list mt-4">
                        <div class="row">
                            <div class="col-md-4">
                                <h4 class="service-category-title mb-3">Master and Rig Mover</h4>
                                <ul class="list-unstyled">
                                    <li><i class="bi bi-check2"></i> FPSO</li>
                                    <li><i class="bi bi-check2"></i> AFRAMAX</li>
                                    <li><i class="bi bi-check2"></i> AHTS</li>
                                    <li><i class="bi bi-check2"></i> MODU Semi Sub</li>
                                    <li><i class="bi bi-check2"></i> MODU Drill Ship</li>
                                    <li><i class="bi bi-check2"></i> MODU Jack Up</li>
                                    <li><i class="bi bi-check2"></i> MODU Tender Barge</li>
                                    <li><i class="bi bi-check2"></i> MOU SPJUB</li>
                                </ul>
                            </div>

                            <div class="col-md-4">
                                <h4 class="service-category-title mb-3">Watchkeeper - Tankers</h4>
                                <ul class="list-unstyled">
                                    <li><i class="bi bi-check2"></i> VLCC</li>
                                    <li><i class="bi bi-check2"></i> AFRAMAX</li>
                                    <li><i class="bi bi-check2"></i> Products Tanker</li>
                                    <li><i class="bi bi-check2"></i> Gas Tanker</li>
                                    <li><i class="bi bi-check2"></i> Chemical Tanker</li>
                                </ul>
                            </div>

                            <div class="col-md-4">
                                <h4 class="service-category-title mb-3">Watchkeeper - Others</h4>
                                <ul class="list-unstyled">
                                    <li><i class="bi bi-check2"></i> 3D Survey</li>
                                    <li><i class="bi bi-check2"></i> Self Discharging Bulk Carrier</li>
                                    <li><i class="bi bi-check2"></i> Container/ Bulk Carrier</li>
                                    <li><i class="bi bi-check2"></i> Geared General Cargo</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-xl-6" data-aos="fade-up" data-aos-delay="300">
                    <div id="aboutCarousel" class="carousel slide" data-bs-ride="carousel">
                        <div class="carousel-inner">
                            <!-- Carousel items will be inserted here by JavaScript -->
                        </div>
                        <button class="carousel-control-prev" type="button" data-bs-target="#aboutCarousel" data-bs-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Previous</span>
                        </button>
                        <button class="carousel-control-next" type="button" data-bs-target="#aboutCarousel" data-bs-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Next</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- /About Section -->
</main>

<!-- Add this script section before closing the content section -->
<script>
    // Function to populate the hero slideshow
    function populateHeroSlideshow(data) {
        const slideshow = document.querySelector('#heroSlideshow');
        slideshow.innerHTML = ''; // Clear existing slides
        
        data.slides.forEach((slide, index) => {
            const filename = slide.carousel_image.replace(/\s+/g, '');
            const imagePath = `<?= base_url() ?>/assets/img/background-image/${filename}`;
            
            const slideHtml = `
                <div class="hero-slide ${index === 0 ? 'active' : ''}" 
                     style="background-image: url('${imagePath}')"
                     title="${slide.carousel_title}">
                </div>
            `;
            slideshow.innerHTML += slideHtml;
        });

        // Set up hero slideshow rotation
        setupHeroSlideshow();
    }

    // Function to handle hero slideshow rotation
    function setupHeroSlideshow() {
        const slides = document.querySelectorAll('.hero-slide');
        let currentSlide = 0;

        function rotateSlides() {
            slides[currentSlide].classList.remove('active');
            currentSlide = (currentSlide + 1) % slides.length;
            slides[currentSlide].classList.add('active');
        }

        setInterval(rotateSlides, 5000); // Rotate every 5 seconds
    }

    // Function to populate the about carousel
    function populateAboutCarousel(data) {
        const carouselInner = document.querySelector('#aboutCarousel .carousel-inner');
        carouselInner.innerHTML = ''; // Clear existing slides
        
        data.slides.forEach((slide, index) => {
            const filename = slide.carousel_image.replace(/\s+/g, '');
            const imagePath = `<?= base_url() ?>/assets/img/background-image/${filename}`;
            
            const slideHtml = `
                <div class="carousel-item ${index === 0 ? 'active' : ''}">
                    <img src="${imagePath}" class="d-block w-100 rounded-4" alt="${slide.carousel_alt}">
                    <div class="carousel-caption">
                        <h5>${slide.carousel_title}</h5>
                    </div>
                </div>
            `;
            carouselInner.innerHTML += slideHtml;
        });

        // Initialize Bootstrap carousel after adding slides
        new bootstrap.Carousel(document.querySelector('#aboutCarousel'));
    }

    // Function to fetch carousel data from API
    async function fetchCarouselData(type) {
        try {
            const response = await fetch(`<?= base_url() ?>/api/carousel-data?type=${type}`);
            
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            
            const data = await response.json();
            console.log(`Received ${type} data:`, data); // Debug log
            
            if (!data.error) {
                if (type === 'hero') {
                    populateHeroSlideshow(data);
                } else {
                    populateAboutCarousel(data);
                }
            } else {
                console.error('API returned error:', data.message);
            }
        } catch (error) {
            console.error(`Error fetching ${type} carousel data:`, error);
            console.error('Error details:', error.message);
        }
    }

    // Initialize both carousels when DOM is loaded
    document.addEventListener('DOMContentLoaded', function() {
        console.log('DOM loaded, fetching carousel data...'); // Debug log
        fetchCarouselData('hero');
        fetchCarouselData('about');
    });
</script>

<style>
    /* Add these styles for better caption visibility */
    .carousel-caption {
        background: rgba(0, 0, 0, 0.7);
        border-radius: 8px;
        padding: 20px;
        bottom: 20px;
        left: 20px;
        right: 20px;
        text-align: left;
    }

    .carousel-caption h5 {
        color: #fff;
        font-size: 1.2rem;
        margin-bottom: 10px;
        font-weight: 600;
    }

    .carousel-caption p {
        color: #fff;
        font-size: 1rem;
        margin-bottom: 0;
    }

    /* Style for service category titles */
    .service-category-title {
        color: #333;
        font-size: 1.1rem;
        font-weight: 600;
        margin-bottom: 15px;
    }

    /* Style for service list items */
    .service-list li {
        font-size: 0.9rem;
        margin-bottom: 8px;
        color: #555;
    }

    .service-list .bi-check2 {
        color: #0066cc;
        margin-right: 8px;
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
        .service-list .col-md-4:not(:last-child) {
            margin-bottom: 30px;
        }
    }

    /* Add styles for hero slideshow */
    .hero-slideshow {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 1;
    }

    .hero-slide {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        opacity: 0;
        transition: opacity 1s ease-in-out;
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
    }

    .hero-slide.active {
        opacity: 1;
    }
</style>

<?= $this->endSection() ?>